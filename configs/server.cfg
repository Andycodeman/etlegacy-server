// ET:Legacy Server Configuration
// ETMan's Modded Server - Jaymod-style Crazy Mode
//
///////////////////////////////////////////////////////////////////////////////
//  ⚠️  IMPORTANT: CONFIG LOAD ORDER  ⚠️
///////////////////////////////////////////////////////////////////////////////
//
//  ET:Legacy RESETS most CVARs to defaults on each map load!
//  Therefore, gameplay CVARs must be re-applied after each map change.
//
//  LOAD ORDER (on each map load):
//    1. server.cfg       - Runs once at server startup only
//    2. crazymode.cfg    - Runs on EVERY map load (via Lua et_InitGame)
//    3. mapconfigs/*.cfg - Per-map overrides (Lua re-execs AFTER crazymode)
//
//  WHERE TO EDIT SETTINGS:
//    - Server identity, network, admin, bots → Edit HERE (server.cfg)
//    - Gameplay CVARs (gravity, speed, knockback, g_misc, g_shove, etc.)
//      → Edit crazymode.cfg (this file's values get overwritten!)
//    - Per-map overrides (different gravity, timelimit, etc.)
//      → Edit mapconfigs/<mapname>.cfg
//
//  ⚠️  DO NOT edit gameplay CVARs below! They will be overwritten by
//      crazymode.cfg on map load. Edit crazymode.cfg instead!
//
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// SERVER IDENTITY
///////////////////////////////////////////////////////////////////////////////
set sv_hostname "^1ETMan's ^3Custom ET:Legacy ^7with ^2LIVE VOICE CHAT"
set server_motd0 "^3Welcome to ETMan's Custom Server!"
set server_motd1 "^2LIVE VOICE CHAT: ^7Hold ^3, ^7for team, ^3. ^7for all"
set server_motd2 "^5ROCKET MODES: ^7Select Panzer again to cycle modes"
set server_motd3 "^6SURVIVAL: ^7+5 kills=fire rate, +30s=speed, 30 kills=PANZERFEST!"
set server_motd4 "^7Press ESC > Server Info for full details"

///////////////////////////////////////////////////////////////////////////////
// ADMIN SETTINGS
///////////////////////////////////////////////////////////////////////////////
set rconpassword "emma01"

///////////////////////////////////////////////////////////////////////////////
// NETWORK SETTINGS
///////////////////////////////////////////////////////////////////////////////
set net_port "27960"
set sv_maxclients "16"
set sv_privateclients "0"
set sv_allowDownload "1"
set sv_wwwDownload "1"
set sv_wwwBaseURL "http://etdl.coolip.me"
set sv_wwwFallback "1"
set sv_wwwDlDisconnected "0"            // Keep clients connected during HTTP download (helps avoid dlcache issues)
set sv_dlRate "0"
set sv_dl_maxRate "0"
set sv_maxRate "0"
set sv_pure "1"
set sv_timeout "120"
set sv_dl_timeout "300"

///////////////////////////////////////////////////////////////////////////////
// GAME SETTINGS
///////////////////////////////////////////////////////////////////////////////
set g_gametype "2"                    // 2 = Objective
set timelimit "30"
set g_warmup "8"                      // 8 second warmup countdown at map start
set g_doWarmup "0"                    // Disable warmup requiring ready (just start)
set match_warmupDamage "2"            // Full warmup damage
set match_readypercent "0"            // No ready percentage needed
set match_minplayers "0"              // No minimum players to start
set g_allowVote "1"

///////////////////////////////////////////////////////////////////////////////
// CRAZY MODE - MOVEMENT & PHYSICS
// ⚠️  WARNING: These values are OVERWRITTEN by crazymode.cfg on map load!
//     Edit crazymode.cfg instead, not here!
///////////////////////////////////////////////////////////////////////////////
// Gravity: 800=normal, 450=floaty, 350=moon-like
set g_gravity "450"

// Player speed (default 320, lower = slower)
set g_speed "310"

// Knockback settings (ETMan custom)
// g_knockback: multiplier (stock 1000, ETMan default 2000)
// g_knockbackCap: 0 = no cap, otherwise max knockback value (stock was hardcoded 200)
// g_knockbackTeammates: 1 = apply knockback to teammates (for rocket fun!)
// Formula: velocity = min(damage, knockbackCap) * g_knockback / 200
// With cap=150, knockback=2000: velocity = 150 * 2000 / 200 = 1500
set g_knockback "2000"
set g_knockbackCap "150"
set g_knockbackTeammates "1"

// g_shove: Player shove/push force when pressing F near another player
// Default is 60, formula: push_velocity = g_shove * 5
// 60 = 300 units/sec (weak), 1000 = 5000 units/sec (MEGA PUSH!)
set g_shove "1000"
set g_shoveNoZ "0"

// g_misc flags (ETMan mod - JayMod-style):
// 1 = Z-axis shove boost (enables full vertical push power)
// 2 = double jump
// 4 = no fall damage
// 8 = unlimited sprint/stamina
// 16 = no self damage
// 32 = panzer war (all classes can use panzerfaust)
// Combined: 1+2+4+32 = 39 (Z-shove + double jump + no fall + panzer war)
// Note: Removed unlimited sprint (8) so adrenaline syringe matters!
set g_misc "39"

///////////////////////////////////////////////////////////////////////////////
// TEAMS
///////////////////////////////////////////////////////////////////////////////
set team_maxplayers "0"
set team_nocontrols "1"
set g_teamForceBalance "1"

// Fast respawn (in milliseconds - these override map defaults)
// g_userAllied/AxisRespawnTime only work if maps check them
// Use g_bluelimbotime and g_redlimbotime for guaranteed override
set g_userAlliedRespawnTime "5"
set g_userAxisRespawnTime "5"
set g_bluelimbotime "5000"            // Allied respawn in ms (5 sec)
set g_redlimbotime "5000"             // Axis respawn in ms (5 sec)

///////////////////////////////////////////////////////////////////////////////
// CLASS LIMITS (no restrictions)
///////////////////////////////////////////////////////////////////////////////
set team_maxSoldiers "-1"
set team_maxMedics "-1"
set team_maxEngineers "-1"
set team_maxFieldops "-1"
set team_maxCovertops "-1"

// Heavy weapon limits
set team_maxMortars "-1"
set team_maxFlamers "-1"
set team_maxMg42s "-1"
set team_maxPanzers "-1"
set team_maxRiflegrenades "-1"

///////////////////////////////////////////////////////////////////////////////
// CHARGE TIMES (faster = more action)
///////////////////////////////////////////////////////////////////////////////
set g_soldierChargeTime "1000"        // Soldier special - 1 second recharge!
set g_engineerChargeTime "1000"       // Engineer special - 1 second
set g_medicChargeTime "1000"          // Medic special - 1 second
set g_fieldopsChargeTime "1000"       // Field Ops special - 1 second
set g_covertopsChargeTime "1000"      // Covert Ops special - 1 second

///////////////////////////////////////////////////////////////////////////////
// CRAZY MODE - WEAPON SETTINGS (ETMan custom CVARs)
///////////////////////////////////////////////////////////////////////////////
// Adrenaline stacking - each shot adds time, can store up to max
set g_adrenalineAdd "10000"           // Time added per shot in ms (10000 = 10 seconds)
set g_adrenalineMax "999000"          // Maximum stored time in ms (999000 = 999 seconds)

// SMG fire rate - affects MP40 and Thompson
// Stock: 150ms between shots (400 RPM)
// Crazy: 50ms between shots (1200 RPM, same as MG42!)
set g_smgFireRate "50"                // Time between shots in ms (0 = use stock 150)

// Grenade settings
// Fire rate: stock 1600ms, crazy 100ms (rapid fire spam!)
// Instant: 1=instant throw (no cooking), 0=normal cooking
set g_grenadeFireRate "100"           // Time between throws in ms (0 = use stock 1600)
set g_grenadeInstant "1"              // 1=instant throw, 0=hold to cook

// Panzerfaust/Bazooka settings (0 = use stock values)
// Stock: damage=400, splash=400, radius=300, speed=2500
set g_panzerDamage "0"                // Direct hit damage (0 = stock 400)
set g_panzerSplash "0"                // Splash damage (0 = stock 400)
set g_panzerRadius "200"              // Splash radius (stock 300, tighter = harder team kills)
set g_panzerSpeed "2750"              // Projectile speed (stock 2500, 10% faster)

// Screen shake intensity (0=off, 100=normal, 200=double)
set g_shakeIntensity "0"              // Disable screen shake from explosions

// Fall damage (1=on, 0=off)
set g_fallDamage "1"                  // Enable fall damage (for knockback into walls/ground)

///////////////////////////////////////////////////////////////////////////////
// LIVES & RESPAWN
///////////////////////////////////////////////////////////////////////////////
set g_alliedmaxlives "0"
set g_axismaxlives "0"
set g_maxlives "0"

///////////////////////////////////////////////////////////////////////////////
// XP SETTINGS
///////////////////////////////////////////////////////////////////////////////
set g_XPSave "1"
set g_XPSaveMaxAge "604800"           // 1 week

// Skill levels - XP required for each level (4 levels total)
// Default: "20 50 90 140" - Set all to 0 for instant max skills
set skill_soldier "0 0 0 0"
set skill_medic "0 0 0 0"
set skill_engineer "0 0 0 0"
set skill_fieldops "0 0 0 0"
set skill_covertops "0 0 0 0"
set skill_battlesense "0 0 0 0"
set skill_lightweapons "0 0 0 0"

///////////////////////////////////////////////////////////////////////////////
// FRIENDLY FIRE
///////////////////////////////////////////////////////////////////////////////
set g_friendlyFire "0"                // Off (change to 1 for chaos mode)

///////////////////////////////////////////////////////////////////////////////
// ANTI-CHEAT & LOGGING
///////////////////////////////////////////////////////////////////////////////
set pb_sv_disable "1"
set sv_cheats "0"
set g_log "server.log"
set g_logSync "1"
set logfile "2"

// IMPORTANT: Disable defaultpublic.config which overrides our settings!
set g_customConfig ""

///////////////////////////////////////////////////////////////////////////////
// LUA SCRIPTS
///////////////////////////////////////////////////////////////////////////////
set lua_modules "lua/main"
set lua_allowedModules ""

// Rick Roll Mode - spinning wheel lottery that gives random effects
// 0 = disabled, 1 = enabled
set g_rickrollEnabled "0"

///////////////////////////////////////////////////////////////////////////////
// ETPANEL INTEGRATION
///////////////////////////////////////////////////////////////////////////////
set etpanel_enabled "1"
set etpanel_api_url "https://etpanel.coolip.me/api"
set etpanel_api_key "214f3ddbb1098e5709661f5ace51dc21"
set etpanel_debug "0"

///////////////////////////////////////////////////////////////////////////////
// OMNI-BOT
///////////////////////////////////////////////////////////////////////////////
set omnibot_enable "1"
set omnibot_path "./omni-bot"
set omnibot_flags "0"

// Bot auto-fill (keeps server populated)
set bot_minplayers "12"

///////////////////////////////////////////////////////////////////////////////
// MAP-SPECIFIC CONFIGS
// Looks for mapconfigs/<mapname>.cfg and execs it on map load
///////////////////////////////////////////////////////////////////////////////
set g_mapConfigs "mapconfigs"

///////////////////////////////////////////////////////////////////////////////
// MAP ROTATION
// Custom maps: baserace, snatch3, ctf_face_b1, fragmaze_fixed, et_mor2_night_final, fa_bremen_final, santas_delivery_b1, mml_minastirith_fp3, capuzzo_final
///////////////////////////////////////////////////////////////////////////////
set d1 "map baserace; set nextmap vstr d2"
set d2 "map snatch3; set nextmap vstr d3"
set d3 "map ctf_face_b1; set nextmap vstr d4"
set d4 "map fragmaze_fixed; set nextmap vstr d5"
set d5 "map et_mor2_night_final; set nextmap vstr d6"
set d6 "map fa_bremen_final; set nextmap vstr d7"
set d7 "map santas_delivery_b1; set nextmap vstr d8"
set d8 "map mml_minastirith_fp3; set nextmap vstr d9"
set d9 "map capuzzo_final; set nextmap vstr d1"

// Start rotation
vstr d1
